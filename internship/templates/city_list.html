{% extends "base.html" %}
{% load user_filters %}
{% load thumbnail %}

<title>
  {% block title %}
    The list of cities
  {% endblock %}
</title>

{% block content %}
<body>
<div class="container-fluid mt-3">
	<div class="row">
    <!--menu -->
    <div class="col-lg-3 mx-auto">
        <div class="list-group">
            <a class="list-group-item active" href="{% url 'cities:add_city' country %}">Add City</a>
            <a href="{% url 'cities:city_list' country %}" class="list-group-item list-group-item-action">All cities</a>
            <a href="{% url 'cities:city_list' country %}?with_mcdonalds=True" class="list-group-item list-group-item-action">Cities with McDonald's</a>
            <a href="{% url 'cities:city_list' country %}?with_mcdonalds=False" class="list-group-item list-group-item-action">Cities without McDonald's</a>
        </div>
    </div>
       <!--data-table -->
    <div class="col-lg-9 mx-auto">
    <div class="row mx-auto">
     {% if page %}
        <table class="table table-image display cell-border" id="city-table" >
           <thead>
             <tr>
               <th scope="col">â„–</th>
               <th scope="col">Emblem</th>
               <th scope="col">City</th>
               <th scope="col">Population</th>
               <th scope="col">With a McDonald's outlet</th>
               {% if user.is_authenticated %}
               <th scope="col">Edit city</th>
               {% endif %}
               {%  if user.is_staff %}
               <th scope="col">Delete city</th>
               {% endif %}
               </tr>
           </thead>
            <tbody >
             {% for city in page %}
              <tr>
                 <th scope="row"> {{ forloop.counter0|add:page.start_index }}</th>
                  <td class="w-10">{% thumbnail city.emblem "50x25" crop="center" upscale=True as im %}
                            <img class="img-fluid img-thumbnail" src="{{ im.url }}">
                        {% endthumbnail %}</td>
                   <td ><a class="nav-link" href="{% url 'cities:city_detail' city.pk %}">{{ city.name }}</a></td>
                  {% if city.population < 500000 %} <td style="color:#DC143C"> {{ city.population }} </td>
                  {% elif city.population < 1000000 %} <td style="color:#000080"> {{ city.population }} </td>
                  {% else %} <td style="color:#3CB371"> {{ city.population }} </td> {% endif %}
                  <td >{{ city.with_mcdonalds|add_image }}</td>
                  {% if user.is_authenticated %}
                  <td ><a class="btn btn-sm btn-primary" href="{% url 'cities:edit_city' city.id %}" role="button">Edit city</a></td>
                  {% endif %}
                  {% if user.is_staff %}
                  <td ><a class="btn btn-sm btn-danger" href="{% url 'cities:delete_city' city.id %}" role="button">Delete city</a></td>
                  {% endif %}
             </tr>
            {% endfor %}
            </tbody>
        </table>
    {% endif %}
    </div>
    </div></div></div>

{% include "includes/paginator.html" with items=page paginator=paginator %}

{% block js %}
    <script type="text/javascript">
        $(document).ready(function() {
            $('#city-table').DataTable({
                paging: false,
                searching: false,
                info: false,
                columnDefs: [
                    {
                        targets: "_all",
                        className: 'dt-center'
                    }
                ]
            } );
        });
    </script>
{% endblock js %}
</body>
{% endblock %}